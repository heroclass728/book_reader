{% load static %}
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>

  {# Preventing from google index #}
  <meta name="robots" content="noindex">

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="title" content>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="distribution" content="Global">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">

  <!-- CSS Global Compulsory -->
  <link rel="stylesheet" href="{% static 'plugins/bootstrap/css/bootstrap.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/style.css' %}">

  <!-- CSS Header and Footer -->
  <link rel="stylesheet" href="{% static 'css/header-default.css' %}">

  <!-- CSS Implementing Plugins -->
  <link rel="stylesheet" href="{% static 'plugins/line-icons/line-icons.css' %}">
  <link rel="stylesheet" href="{% static 'plugins/font-awesome/css/font-awesome.min.css' %}">
  <link rel="stylesheet" href="{% static 'plugins/revolution-slider/rs-plugin/css/settings.css' %}">

  <!-- PAGE CSS -->
  <link href="{% static 'css/page-home.css' %}" rel="stylesheet" type="text/css">
  <link href="{% static 'css/page-dsnac.css' %}" rel="stylesheet" type="text/css">

  <!-- CSS Theme -->
  <link rel="stylesheet" href="{% static 'css/theme-colors/default.css' %}" id="style_color">

  <!-- CSS Customization -->
  <link href="{% static 'css/custom.css' %}" rel="stylesheet" type="text/css">

  <script type="text/javascript">window.q = [];</script>
  <meta http-equiv="X-UA-Compatible" content="chrome=1"> <!-- Enable Chrome Frame for IE -->

  <title>{% block title %}{% endblock %} - Sikh National Archives of Canada </title>
  <style>
    .search-results {
      opacity: 1 !important;
    }
  </style>
  {% block extra_css %}{% endblock %}
</head>

<body id="home">
<script>
  document.body.className += ' client-js';
</script>
<span id="top"></span>

<div class="wrapper">
  <!--=== Header ===-->
  <div class="header">
    <div class="container header_wrapper">
      <!-- Logo -->
      <a class="logo" href="/" title="Sikh National Archives">
        <img id="logo-header" src="{% static 'images/top.png' %}" height="47" alt="logo" class="desktop" />
        <img src="{% static 'img/theme/snac_logo.png' %}" height="47" alt="logo" class="mobile" />
      </a>
      <!-- End Logo -->
      <!-- Topbar -->
      <div class="topbar">
        {% if user.is_authenticated %}
          <div class="account-component pull-right mobile" style="display: none">
            <div class="dropdown-avatar">
              <button class="avatar" id="userToggle" aria-label="My account" style="background-image: url('https://archive.org/services/img/@hqpr');"></button>
              <img class="down-arrow" aria-hidden="true" alt="My Account" role="presentation" src="/static/images/down-arrow.png">
            </div>
            <div class="account-dropdown navigation-dropdown-component" id="main-account-dropdown">
              <ul class="dropdown-menu">
                <li><a href="{% url 'user_detail' user.id %}">My Profile</a></li>
                <li>
                  <a href="{% url 'account_logout' %}">Log Out</a>
                </li>
              </ul>
            </div>
          </div>
        {% endif %}
        <ul class="loginbar pull-right">
          <li><a class="btn-u btn-u-sea btn-u-xs rounded btn-brd btn-brd-hover" href="{% url 'donate' %}">Donate <span class="heart" aria-hidden="true">â™¥</span></a></li>
          {% if not user.is_authenticated %}
          <li class="topbar-devider desktop"></li>
          <li class="desktop"><a href="{% url 'account_signup' %}">Singup</a></li>
          <li class="topbar-devider desktop"></li>
          <li class="desktop"><a href="{% url 'account_login' %}">Login</a></li>
          {% endif %}
        </ul>
      </div>
      <!-- End Topbar -->
      <div class="mobile_search_wrapper" style="float: left; margin-top: -8px">
        <i class="search fa fa-search search-btn" style="display: none"></i>
        <div class="search-open mobile" style="display: none">
          <form class="search-bar-input input-group" action="/quick/search/" method="get" style="top: 12px;">
            {% csrf_token %}
            <input type="text" name="q" class="form-control" placeholder="Search" autocomplete="off" id="live_search" style="padding-left: 15px;">
            <span class="input-group-btn">
              <input class="btn-u btn-u-sea search-bar-submit" type="submit" value="Go" />
            </span>
          </form>
        </div>
      </div>
      <!-- Toggle get grouped for better mobile display -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="fa fa-bars"></span>
      </button>
      <!-- End Toggle -->
    </div><!--/end container-->
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse mega-menu navbar-responsive-collapse" style="max-width: 960px; margin: 0 auto;">
      <div class="container" style="width: 100%; padding: 0;">
        {% if user.is_authenticated %}
          <div class="account-component pull-right desktop">
            <div class="dropdown-avatar">
              <button class="avatar" id="userToggle" aria-label="My account" style="background-image: url('https://archive.org/services/img/@hqpr');"></button>
              <img class="down-arrow" aria-hidden="true" alt="My Account" role="presentation" src="/static/images/down-arrow.png">
            </div>
            <div class="account-dropdown navigation-dropdown-component" id="main-account-dropdown">
              <ul class="dropdown-menu" style="right: 11px; margin: 0">
                <li><a href="{% url 'user_detail' user.id %}">My Profile</a></li>
                <li>
                  <a href="{% url 'account_logout' %}">Log Out</a>
                </li>
              </ul>
            </div>
          </div>
        {% endif %}
        <div class="search-open desktop">
          <form class="search-bar-input input-group" action="/quick/search/" method="get">
            <input type="text" name="q" class="form-control live_search" placeholder="Search" autocomplete="off" style="padding-left: 15px;">
            <span class="input-group-btn">
              <input class="btn-u btn-u-sea search-bar-submit" type="submit" value="Go" />
            </span>
          </form>

          <div class="search-dropdown">
            <ul class="search-results" style="opacity: 1;">
            </ul>
          </div>

        </div>
        <ul class="nav navbar-nav">
          <!-- Browse Pages -->
          <li class="active dropdown">
            <a href="javascript:void(0);" class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown">
              Browse
            </a>
            <ul class="dropdown-menu">
              {% for cat in categories %}
                <li><a href="{% url 'category_detail' cat.id %}">{{ cat.name }}</a></li>
              {% endfor %}
            </ul>
          </li>
          <!-- End Browse Pages -->
          <!-- My Books -->
          <li class="dropdown">
            <a href="javascript:void(0);" class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown">
              My Books
            </a>
            <ul class="dropdown-menu">
              <li><a href="{% url 'my_loans' %}">My Loans</a></li>
              <li><a href="{% url 'my_reading' %}">My Reading Log</a></li>
            </ul>
          </li>
          <!-- End My Books -->
          <!-- More Options -->
          <li class="dropdown">
            <a href="javascript:void(0);" class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown" data-delay="1000">
              More
            </a>
            <ul class="dropdown-menu">
              <li><a href="{% url 'add_book' %}">Add a Book</a></li>
              <li><a href="/search/">Advanced Search</a></li>
            </ul>
          </li>
          <!-- End More Options -->
        </ul>
      </div><!--/end container-->
    </div><!--/navbar-collapse-->
  </div>
  <!--=== End Header ===-->
</div>

<div id="test-body-mobile">

  <div id="contentHead">
    {% block content_head %}{% endblock %}
    {% block content %}{% endblock content %}
    <table width="100%">
      <tbody>
      <tr>
        <td valign="top" width="100%">
          <div id="editTools" class="edit">
            <div id="editButton">
            </div>
            <div id="editInfo">
              <div class="brown smaller sansserif"></div>
              <div class="smallest gray sansserif"></div>
            </div>
          </div>
          <div class="navEdition sansserif">
            <span></span>
          </div>
        </td>
      </tr></tbody></table>
  </div>
  <div id="contentBody">
  </div>
</div>


<div class="clearfix"></div>

<footer>
  <div id="footer-content">
    <hr>
    <div id="footer-details">
      <img id="archive-logo" src="{% static 'img/theme/snac_logo.png' %}" alt aria-hidden="true">
      <div id="legal-details">
        <span>Copyright {% now 'Y' %} Sikh National Archives of Canada</span>
      </div>
    </div>
  </div>
</footer>

<!-- JS Global Compulsory -->
<script src="{% static 'js/jquery-3.1.1.min.js' %}"></script>
<script src="{% static 'plugins/bootstrap/js/bootstrap.min.js' %}"></script>
<script src="{% static 'js/vendor-v2.js' %}" type="text/javascript"></script>
<script src="{% static 'js/all.js' %}" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
<script src="{% static 'plugins/revolution-slider/rs-plugin/js/jquery.themepunch.tools.min.js' %}" type="text/javascript"></script>
<script src="{% static 'plugins/revolution-slider/rs-plugin/js/jquery.themepunch.revolution.min.js' %}" type="text/javascript"></script>
<script src="{% static 'js/revolution-slider.js' %}" type="text/javascript"></script>

<script type="text/javascript" src="{% static 'js/app.js' %}"></script>

<script>
  jQuery(document).ready(function() {
    App.init();
    RevolutionSlider.initRSfullWidth();
  });
</script>


<script>
  $(function () {
    var i;
    for (i = 0; i < window.q.length; i++) {
      $(window.q[i]);
    }
    window.q = [];
  });
  function toasterOptions() {
    toastr.options = {
      "closeButton": true,
      "newestOnTop": true,
      "progressBar": true,
      "preventDuplicates": true,
      "onclick": null,
      "showDuration": "100",
      "hideDuration": "1000",
      "timeOut": "5000",
      "extendedTimeOut": "1000",
      "showEasing": "swing",
      "hideEasing": "linear",
      "showMethod": "show",
      "hideMethod": "hide"
    };
  }
  toasterOptions();
  {% if messages %}
    {% for message in messages %}
      toastr.{{ message.tags }}("{{ message }}");
    {% endfor %}
  {% endif %}

  let getUrlParameter = function getUrlParameter(sParam) {
    let sPageURL = window.location.search.substring(1),
      sURLVariables = sPageURL.split('&'),
      sParameterName,
      i;
    for (i = 0; i < sURLVariables.length; i++) {
      sParameterName = sURLVariables[i].split('=');
      if (sParameterName[0] === sParam) {
        return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
      }
    }
  };

  $('form').submit(function() {
    $(this).find("button[type='submit']").prop('disabled',true);
  });

  $(document).ready(function () {

    $('.live_search').on('input', function () {
      $.ajax({
        url: "{% url 'prefetch_search' %}",
        type: 'post',
        dataType: 'json',
        data: $('.search-bar-input').serialize(),
        success: function(data) {
          $('.search-results').empty();
          if (data.length > 0) {
            data.forEach(function (item) {
              let snip = '<li class="instant-result"><a href="/book/'+item.slug+'/"><img src="'+item.cover+'"><span class="book-desc"><div class="book-title">' + item.name + '</div>by <span class="book-author">'+item.creator__name+'</span></span></a></li>';
              $('.search-results').append(snip);
            });
          }
        },
        complete: function (data) {
          $('.search-results').css('opacity', 1);
        }
      });


    })
  })

</script>
{% block extra_js %}{% endblock extra_js %}
</body>
</html>