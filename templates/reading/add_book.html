{% extends 'base.html' %}
{% load static %}
{% block extra_css %}
  <link href="{% static 'css/page-user.css' %}" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="{% static 'plugins/sky-forms-pro/skyforms/css/sky-forms.css' %}">
  <link rel="stylesheet" href="{% static 'plugins/sky-forms-pro/skyforms/custom/custom-sky-forms.css' %}">
{% endblock %}
{% block title %}Upload a book{% endblock title %}

{% block content_head %}
  <h1>Input details of new book</h1>
{% endblock %}

{% block content %}
  <section>
    <div class="row bookForm">
      <form action="{% url 'save_book' %}" class="olform addbook1 validate sky-form" enctype="multipart/form-data" method="post" id="bookUploadForm" style="border: none;">
        {% csrf_token %}

        <fieldset style="padding-top: 0">
          <section>
            <label class="label">Book title *</label>
            <label class="input">
              <input type="text" name="book_title" id="id_book_title" class="" required />
            </label>
          </section>

          <section>
            <label class="label">Description *</label>
            <label class="textarea">
              <textarea name="description" id="id_description" class="required" placeholder="Add a description of the item page" rows="3" required></textarea>
            </label>
          </section>

          <section>
            <label class="label">Subject Tags *</label>
            <label class="input">
              <input type="text" name="tags" id="id_tags" class="" placeholder="Add keywords, separated by commas" required>
            </label>
          </section>

          <div class="row">
            <section class="col col-6">
              <label class="label">Category</label>
              <label class="select">
                {{ form.category }}
                <i></i>
              </label>
            </section>

            <section class="col col-6">
              <label class="label">Creator</label>
              <label class="input">
                <input type="text" name="creator" id="id_creator" class="" placeholder="Creator of the content">
              </label>
            </section>
          </div>

          <section>
            <label class="label">File input * <br>
              <span><small>Only PDF file allowed</small></span>
            </label>
            <label for="file" class="input input-file">
              <div class="button"><input type="file" name="file" id="id_file" onchange="this.parentNode.nextSibling.value = this.value" required />Browse</div><input type="text" readonly>
            </label>
          </section>

          <section>
            <label class="label">Year published *</label>
            <label class="input">
              <input type="text" name="published" id="id_published" class="" placeholder="Date work was created/published">
            </label>
          </section>

          <div class="row">
            <section class="col col-6">
              <label class="label">Collection *</label>
              <label class="select">
                {{ form.collection }}
                <i></i>
              </label>
            </section>

            <section class="col col-6">
              <label class="label">Test Item</label>
              <label class="select">
                {{ form.test_item }}
                <i></i>
              </label>
            </section>
          </div>

          <div class="row">
            <section class="col col-6">
              <label class="label">Language</label>
              <label class="select">
                {{ form.language }}
                <i></i>
              </label>
            </section>

            <section class="col col-6">
              <label class="label">Licence</label>
              <label class="select">
                {{ form.licence }}
                <i></i>
              </label>
            </section>
          </div>

          <div id="sections">
            <label>Meta Tags</label>
            <div class="section">
              <div class="pull-left" style="width: 50%">
                <input type="text" class="" placeholder="Key" name="meta_key">
              </div>
              <div class="pull-left" style="width: 50%">
                <input type="text" class="" placeholder="Value" name="meta_value">
              </div>
            </div>
          </div>
          <a class="btn btn-default addsection" href=""><i class="fa fa-plus"></i> Add more</a>

          <section style="margin-top: 20px;">
            <button type="submit" id="uploadBook" class="btn-u btn-u-sea pull-left">Upload and Create Your Item</button>
          </section>
        </fieldset>




        <!-- <div class="formElement">
          <div class="label"><label for="id_book_title" class="">Book title *</label></div>
          <div class="input">
            <input type="text" name="book_title" id="id_book_title" class="" required>
          </div>
        </div> -->

        <!-- <div class="formElement">
          <div class="label"><label for="id_description" class="">Description *</label></div>
          <div class="input">
                          <textarea name="description" id="id_description" class="required"
                      placeholder="Add a description of the item page" required></textarea>
          </div>
        </div> -->

        <!-- <div class="formElement">
          <div class="label"><label for="id_tags" class="">Subject Tags *</label></div>
          <div class="input">
            <input type="text" name="tags" id="id_tags" class=""
                   placeholder="Add keywords, separated by commas" required>
          </div>
        </div> -->

        <!-- <div class="formElement">
            <div class="label"><label for="id_category" class="">Category</label></div>
            <div class="input">
              {{ form.category }}
            </div>
          </div> -->

        <!-- <div class="formElement">
          <div class="label"><label for="id_creator" class="">Creator</label></div>
          <div class="input">
            <input type="text" name="creator" id="id_creator" class=""
                   placeholder="Creator of the content">
          </div>
        </div> -->

        <!-- <div class="formElement">
            <div class="label"><label for="id_file" class="">File *</label></div>
            <div class="input">
              {{ form.file }}
            </div>
          </div> -->

        <!-- <div class="formElement">
          <div class="label"><label for="id_published" class="">Year published *</label></div>
          <div class="input">
            <input type="text" name="published" id="id_published" class=""
                   placeholder="Date work was created/published">
          </div>
        </div> -->

        <!-- <div class="formElement">
            <div class="label"><label for="id_collection" class="">Collection *</label></div>
            <div class="input">
              {{ form.collection }}
            </div>
          </div> -->

        <!-- <div class="formElement">
            <div class="label"><label for="id_test_item" class="">Test Item</label></div>
            <div class="input">
              {{ form.test_item }}
            </div>
          </div> -->

        <!-- <div class="formElement">
            <div class="label"><label for="id_language" class="">Language</label></div>
            <div class="input">
              {{ form.language }}
            </div>
          </div> -->

        <!-- <div class="formElement">
            <div class="label"><label for="id_licence" class="">Licence</label></div>
            <div class="input">
              {{ form.licence }}
            </div>
          </div> -->

        <!-- <div id="sections">
          <div class="formElement">
            <label for="id_licence">Meta Tags</label>
            <div class="section">
              <div class="pull-left" style="width: 50%">
                <input type="text" class="" placeholder="Key" name="meta_key">
              </div>
              <div class="pull-left" style="width: 50%">
                <input type="text" class="" placeholder="Value" name="meta_value">
              </div>
            </div>
          </div>
        </div> -->
        <!-- <a class="btn btn-default addsection" href=""><i class="fa fa-plus"></i> Add more</a> -->

        <!-- <div class="" style="margin-left: 0px;">
          <div class="">
            <button type="submit" id="uploadBook" class="cta-btn cta-btn--available">Upload and Create Your Item</button>
          </div>
        </div> -->
      </form>
    </div>
    <div class="row well wait hide">
      <div class="progress">
        <progress class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar"
                  id="progressbar" value="10" max="100"
                  aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 100%">

        </progress>
      </div>
    </div>
    <!-- </div> -->
  </section>


{% endblock content %}
{% block extra_js %}
  {#  <script src="{% static 'js/dropzone.js' %}"></script>#}
  <script>
    let template = $('#sections .section:first').clone();
    let sectionsCount = 1;
    $('body').on('click', '.addsection', function() {
      sectionsCount++;
      let section = template.clone().find(':input').each(function(){
        let newId = this.id + sectionsCount;
        $(this).prev().attr('for', newId);
        this.id = newId;
        this.val='';
      }).end()
        .appendTo('#sections');
      return false;
    });

    let waitWell = $('.wait');

    $('form').submit(function() {
      $(this).find("button[type='submit']").prop('disabled',true);
      waitWell.removeClass('hide');

      let progressbar = $('#progressbar'),
        max = progressbar.attr('max'),
        time = (3000/max)*5,
        value = progressbar.val();

      let loading = function() {
        value += 1;
        addValue = progressbar.val(value);

        $('.progress-value').html(value + '%');

        if (value == max) {
          clearInterval(animate);
        }
      };

      let animate = setInterval(function() {
        loading();
      }, time);

    });

  </script>
{% endblock extra_js %}